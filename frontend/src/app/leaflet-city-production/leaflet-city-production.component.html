<div class="dashboard-container">
  <h1>Produção por Município</h1>

  <div class="filters-container">
    <div class="filter-card">
      <label for="uf">UF</label>
      <div *ngIf="loadingUFs" class="loading">Carregando...</div>
      <select id="uf" [(ngModel)]="selectedUF" [disabled]="loadingUFs">
        <option value="" disabled selected>-- Escolha uma UF --</option>
        <option *ngFor="let uf of ufs" [value]="uf.sigla_uf">
          {{ uf.sigla_uf | ufName }}
        </option>
      </select>
    </div>

    <div class="filter-card year-search">
      <label for="ano">Ano</label>
      <div class="year-input-button">
        <input
          id="ano"
          type="number"
          [(ngModel)]="selectedAno"
          placeholder="Ex: 1988"
          value="2023"
          min="1974"
          max="2023"
        />
        <button (click)="buscarProdutos()">Buscar</button>
      </div>
    </div>
  </div>

  <div id="map" class="map-container"></div>

  <div class="products-container" *ngIf="produtos.length">
    <h2>Selecione um Produto</h2>
    <div class="products-grid">
      <div class="product-card" *ngFor="let p of produtos">
        <div class="product-info">
          <strong>{{ p.produto }}</strong
          ><br />
          Área colhida: {{ p.area_colhida_total | number : "1.0-0" }} ha
        </div>
        <button (click)="selectProduto(p.produto)">Selecionar</button>
      </div>
    </div>
  </div>

  <div
    *ngIf="!loadingProdutos && !produtos.length && selectedUF && selectedAno"
    class="no-data"
  >
    Nenhum produto encontrado para a UF {{ selectedUF }} em {{ selectedAno }}.
  </div>
  <div
    *ngIf="selectedProduto && !municipios.length && !loadingProdutos"
    class="no-data"
  >
    Nenhum município encontrado para o produto "{{ selectedProduto }}".
  </div>
</div>
